<?xml version='1.0' encoding='UTF-8'?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:c="http://java.sun.com/jsp/jstl/core"
      xmlns:rich="http://richfaces.org/rich"
      xmlns:a4j="http://richfaces.org/a4j"
      xmlns:t="http://myfaces.apache.org/tomahawk">

    <a4j:loadScript src="../scripts/jquery.alphanumeric.js" />

	<div id="cadastro">

		<h1 style="width:350px"> Diário de Quilometragem </h1>
		
		<fieldset>
			<legend>Pesquisa</legend>
			<a4j:outputPanel>
				<a4j:region>
					<dl>
						<dt><label>UG:</label></dt>
						<dd>
							<h:selectOneMenu id="ugPesquisa" value="#{diarioKmBean.ugPesquisa}" converter="entityConverter" styleClass="ugList">
								<f:selectItem itemLabel="Todos ..." itemValue="" rendered="#{controlBean.administrador}"/>
								<t:selectItems value="#{ugBean.ugs}" var="ug" itemLabel="#{ug.descricao}" itemValue="#{ug}"/>
							</h:selectOneMenu>
							
						</dd>
						<dt><label>Placa:</label></dt>
						<dd><h:inputText value="#{diarioKmBean.placaPesquisa}"/></dd>
						<dt><label>Chassi:</label></dt>
						<dd>
							<h:inputText value="#{diarioKmBean.chassiPesquisa}"/>
						</dd>
						<dt><label>Renavam:</label></dt>
						<dd><h:inputText value="#{diarioKmBean.renavamPesquisa}"/></dd>
						<dd>
							<h:commandButton value="Pesquisar" action="#{diarioKmBean.pesquisar}">
					      		<a4j:support event="onclick" reRender="dataTableKm"/>
					      	</h:commandButton>
						</dd>
					</dl>
				</a4j:region>
			</a4j:outputPanel>
		</fieldset>

		<fieldset>

	      <legend>Diário de Quilometragem</legend>
	 
		  <rich:dataTable id="dataTableKm" value="#{diarioKmBean.veiculos}" var="veiculo" rows="20" rowKeyVar="index"
				rowClasses="even,odd" width="100%">

				<rich:column style="text-align: center;" > 
					<f:facet name="header"><h:outputText value="Nº" /></f:facet>
					<h:outputText value="#{index+1}" style="color: black;"/>
				</rich:column>
				
				<rich:column > 
					<f:facet name="header"><h:outputText value="UG" /></f:facet>
					<h:outputText value="#{veiculo.ua.ug.descricao}" style="color: black;"/>
				</rich:column>

				<rich:column style="text-align: left;" > 
					<f:facet name="header">
						<h:outputText value="Placa" />
					</f:facet>
					<h:outputText id="placa" value="#{veiculo.placa}" style="color: black;"/>
				</rich:column>
				
				<rich:column style="text-align: left;" > 
					<f:facet name="header">
						<h:outputText value="Modelo" />
					</f:facet>
					<h:outputText id="modelo" value="#{veiculo.modelo.descricao}" style="color: black;"/>
				</rich:column>
				
				<rich:column style="text-align: left;" > 
					<f:facet name="header">
						<h:outputText value="Valor inicial" />
					</f:facet>
					<h:inputText id="vlrInicial" binding="#{diarioKmBean.inputValorInicial}" value="#{veiculo.valorInicial}" style="color: black;" size="6" />
				</rich:column>
				
				<rich:column style="text-align: left;" > 
					<f:facet name="header">
						<h:outputText value="Valor final" />
					</f:facet>
					<h:inputText id="vlrFinal" value="#{veiculo.valorFinal}" style="color: black;" size="6" />
				</rich:column>
				
				
				<rich:column style="text-align: left;" > 
					<f:facet name="header">
						<h:outputText value="Cota Disponível" />
					</f:facet>
					<h:inputText id="cotaDisponivel" disabled="true" 
						value="#{veiculo.cotaKm.cotaKmDisponivel}" style="color: black;" size="8"/>
				</rich:column>
				
				<rich:column style="text-align: left;" > 
					<f:facet name="header">
						<h:outputText value="Salvar" />
					</f:facet>
					<h:commandLink id="salvar" styleClass="salvar" action="#{diarioKmBean.saveDiario}" value="Salvar">
						<f:setPropertyActionListener target="#{diarioKmBean.veiculoSelecionado}" value="#{veiculo}"/>
						<a4j:support event="oncomplete" reRender="paginaPrincipal"/>
					</h:commandLink>
				</rich:column>
				
				<!-- 
				<rich:column width="2%" style="text-align: center;" rendered="#{controlBean.administrador or controlBean.coordenador or controlBean.master}">
					<f:facet name="header"><h:outputText>Editar</h:outputText></f:facet>
					<h:commandLink id="editar" styleClass="editar" action="#{diarioKmBean.prepareEdit}" value="Editar">
						<f:setPropertyActionListener target="#{diarioKmBean.entity}" value="#{diario}"/>
						<a4j:support event="oncomplete" reRender="paginaPrincipal"/>
					</h:commandLink>
				</rich:column>
				
				
				<rich:column width="2%" style="text-align: center;" rendered="#{controlBean.administrador or controlBean.coordenador or controlBean.master}">
					<f:facet name="header"><h:outputText>Excluir</h:outputText></f:facet>
					<h:commandLink id="excluir" styleClass="excluir" action="#{diarioKmBean.delete}" value="Excluir"
						onclick="if(!confirm('Tem certeza que deseja excluir?')){document.getElementById('paginaPrincipal').reset(); return false;}">
						<f:setPropertyActionListener target="#{diarioKmBean.entity}" value="#{diario}"/>
						<a4j:support event="oncomplete" reRender="paginaPrincipal"/>
					</h:commandLink>
				</rich:column>
				 -->
				<f:facet name="footer">
					<rich:datascroller renderIfSinglePage="false" reRender="dataTableKm" for="dataTableKm" />
				</f:facet>

			</rich:dataTable>

	    </fieldset>

	</div>      
	
	<h:commandButton action="#{diarioKmBean.save}" value="Gravar" rendered="true">
		<a4j:support event="onclick" reRender="paginaPrincipal"/>
	</h:commandButton>

	<h:commandButton action="#{diarioKmBean.update}" value="Alterar" rendered="#{bombaBean.updateState}" styleClass="editar">
		<a4j:support event="onclick" reRender="paginaPrincipal"/>	
	</h:commandButton>

	<h:commandButton action="#{diarioKmBean.search}" value="Voltar" immediate="true" rendered="false">
		<a4j:support event="onclick" reRender="paginaPrincipal"/>
	</h:commandButton>

</ui:composition>
