<?xml version='1.0' encoding='UTF-8'?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:c="http://java.sun.com/jsp/jstl/core"
      xmlns:rich="http://richfaces.org/rich"
      xmlns:a4j="http://richfaces.org/a4j"
      xmlns:t="http://myfaces.apache.org/tomahawk">
     
	<div id="cadastro">

		<h1>Simulação</h1>

		<h:outputText value="Veiculo:"/>
		<h:selectOneMenu id="veiculo" value="#{pontoBean.veiculo}" converter="entityConverter">
			<f:selectItem itemLabel="Todos ..." itemValue=""/>
 			<t:selectItems value="#{veiculoBean.veiculos}" var="v" itemLabel="#{v.placa} #{v.modelo.descricao}" itemValue="#{v}"/>
		</h:selectOneMenu>

		<a4j:commandButton value="Rota" action="#{pontoBean.mostrarRotaVeiculo}" reRender="vehicleRoute" styleClass="button">
			<a4j:support event="oncomplete" oncomplete="showVeiculoRoute()"/>
		</a4j:commandButton>

		<p/>
		<a4j:poll id="clockReload" action="#{pontoBean.search}" rendered="#{pontoBean.reload}" 
				  interval="24000" reRender="points"  oncomplete="loadMaps();"/>
		<dd>
			<label for="endereco">Ponto:</label>
			<h:inputText id="endereco" maxlength="50" size="36" style="text-transform:none;"/>
		</dd>

		<dd>
		<label for="velocidade">Velocidade:</label>
			<h:inputText id="velocidade" value="#{pontoBean.velocidade}" maxlength="10" size="4"/>
		</dd>

		<dd>
		<label for="odometro">Odometro:</label>
			<h:inputText id="odometro" value="#{pontoBean.odometro}" maxlength="10" size="4"/>
		</dd>

		<dt>
			<label for="ignicao">Ignição:</label>
			<h:selectOneRadio id="ignicao" value="#{pontoBean.ignicao}" style="width:20%;">
		      	<f:selectItem itemLabel="LIG" itemValue="true"/>
		      	<f:selectItem itemLabel="DESL" itemValue="false"/>
			</h:selectOneRadio>
		</dt>


		<a4j:commandButton value="Ver Ponto" styleClass="button" onclick="showAddress()"/>
		<a4j:commandButton value="Salvar" action="#{pontoBean.salvarLocalizacaoVeiculo}"  styleClass="button">
			<a4j:support event="oncomplete" reRender="points" oncomplete="loadMaps();"/>
		</a4j:commandButton>

		<h:inputHidden id="points" value="#{pontoBean.geoms}"/>
		<h:inputHidden id="vehicleRoute" value="#{pontoBean.route}"/>

		<h:inputHidden id="lat" value="#{pontoBean.lat}"/>
		<h:inputHidden id="lng" value="#{pontoBean.lng}"/>

		<div id="mapp" style="width:100%; height:600px"></div>

	</div>
	
</ui:composition>

