<?xml version='1.0' encoding='UTF-8'?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<ui:composition xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:ui="http://java.sun.com/jsf/facelets"
	  xmlns:c="http://java.sun.com/jstl/core"
      xmlns:rich="http://richfaces.org/rich"
      xmlns:t="http://myfaces.apache.org/tomahawk"
      xmlns:sec="http://www.springframework.org/security/tags"
      xmlns:a4j="http://richfaces.org/a4j">
      
     <a4j:poll id="reloader" action="#{mapBean.showVehiclesRouteOnMap}" interval="120000" reRender="vehicleRoute" oncomplete="showVeiculoRoute();" ajaxSingle="true"/>
      
	<div id="cadastro">

		<h1>Rota de veículo</h1>

		<h:outputText value="Veiculo:"/>
		<h:selectOneMenu id="veiculo" value="#{mapBean.veiculo}" converter="entityConverter">
			<f:selectItem itemLabel="Todos ..." itemValue=""/>
 			<t:selectItems value="#{veiculoBean.veiculosRastreados}" var="v" itemLabel="#{v.placa} #{v.modelo.descricao}" itemValue="#{v}"/>
		</h:selectOneMenu>
		<br/>
		
		<h:outputText value="Início:"/>
		<h:inputText id="dataInicial" value="#{mapBean.start}" styleClass="maskData" style="width:80px">
			<f:convertDateTime dateStyle="short" pattern="dd/MM/yyyy" timeZone="GMT-03:00"/>
		</h:inputText>

		<h:outputText value="Término:"/>
		<h:inputText id="dataFinal" value="#{mapBean.end}" styleClass="maskData"  style="width:80px">
			<f:convertDateTime dateStyle="short" pattern="dd/MM/yyyy" timeZone="GMT-03:00"/>
		</h:inputText>
		

		<a4j:commandButton id="veiculoRota" value="Rota" action="#{mapBean.showVehiclesRouteOnMap}" reRender="vehicleRoute" styleClass="button">
			<a4j:support event="oncomplete" oncomplete="showVeiculoRoute()"/>
		</a4j:commandButton>


		<h:inputHidden id="vehicleRoute" value="#{mapBean.route}"/>

		<div id="mapp" style="width:100%; height:600px"></div>

	</div>

</ui:composition>

