<?xml version='1.0' encoding='UTF-8'?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<ui:composition xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:ui="http://java.sun.com/jsf/facelets"
	  xmlns:c="http://java.sun.com/jstl/core"
      xmlns:rich="http://richfaces.org/rich"
      xmlns:t="http://myfaces.apache.org/tomahawk"
      xmlns:sec="http://www.springframework.org/security/tags"
      xmlns:a4j="http://richfaces.org/a4j">
      
     <a4j:poll id="reloader" action="#{mapBean.showVehiclesRouteOnMap}" interval="60000" reRender="vehicleRoute" oncomplete="showVeiculoRoute();" ajaxSingle="true"/>
      
	<div id="cadastro">

		<h1>Rota de veículo</h1>

		<h:outputText value="Veiculo:"/>
		<h:selectOneMenu id="veiculo" value="#{mapBean.veiculo}" converter="entityConverter">
			<f:selectItem itemLabel="Todos ..." itemValue=""/>
 			<t:selectItems value="#{veiculoBean.veiculosRastreados}" var="v" itemLabel="#{v.placa} #{v.modelo.descricao}" itemValue="#{v}"/>
		</h:selectOneMenu>
		<br/>
		
		<h:selectOneRadio id="tempoConsulta" styleClass="checkbox" value="#{mapBean.tempoConsulta}">
			<f:selectItem itemLabel="Últ. 4h" itemValue="4"/>
			<f:selectItem itemLabel="Últ. 8h" itemValue="8"/>
			<f:selectItem itemLabel="Últ. 16h" itemValue="16"/>
			<f:selectItem itemLabel="Últ. 24h" itemValue="24"/>
			<f:selectItem itemLabel="Últ. 36h" itemValue="36"/>
			<f:selectItem itemLabel="Últ. 48h" itemValue="48"/>
			<f:selectItem itemLabel="Últ. 72h" itemValue="72"/>
			<a4j:support event="onchange" action="#{mapBean.populate}"/>
		</h:selectOneRadio>

		<a4j:commandButton id="veiculoRota" value="Rota" action="#{mapBean.showVehiclesRouteOnMap}" reRender="vehicleRoute" styleClass="button">
			<a4j:support event="oncomplete" oncomplete="showVeiculoRoute()"/>
		</a4j:commandButton>


		<h:inputHidden id="vehicleRoute" value="#{mapBean.route}"/>

		<div id="mapp" style="width:100%; height:600px"></div>

	</div>

</ui:composition>

